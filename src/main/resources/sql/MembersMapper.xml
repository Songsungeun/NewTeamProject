<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="honey.dao.HoneyMembersDao">
  <resultMap type="HoneyMembers" id="memberMap">
    <id column="MB_NO" property="memberNo"/> 
    <id column="MB_NO2" property="followMemberNo"/>
    <result column="EMAIL" property="email"/>
    <result column="MB_NICK" property="nickname"/>
    <result column="MB_NM" property="userName"/>
    <result column="TEL" property="phone"/>
    <result column="BIRTH" property="userBirthDay"/>
    <result column="PWD" property="password"/>
  </resultMap>
  
  <resultMap type="honey_boards" id="boardMap">
    <id column="BD_NO" property="no"/> 
    <result column="MB_NO" property="userNo"/>
    <result column="CT_NO" property="categoryNo"/>
    <result column="BD_TITL" property="title"/>
    <result column="BD_CONTS" property="contents"/>
    <result column="BD_CRE" property="createdDate"/>
    <result column="BD_LIKE" property="like"/>
    <result column="VIEW_CT" property="viewCount"/>
    <result column="URL" property="url"/>
    <result column="URL_Title" property="title"/>
  </resultMap>
  
  
  <insert id="joinMember" parameterType="HoneyMembers" useGeneratedKeys="true" keyProperty="memberNo" keyColumn="MB_NO">
    insert into honey_membs(EMAIL, MB_NICK, MB_NM, TEL, PWD)
    values(#{email}, #{nickname}, #{userName}, #{phone}, password(#{password}))
  </insert>
  
  <insert id="followInsert" parameterType="HoneyMembers" >
    insert into honey_flw(mb_no, mb_no2)
    values(#{memberNo}, #{followMemberNo})
  </insert>
  
  
  
  <select id="selectOneByEmailAndPassword" resultMap="memberMap" parameterType="map">
    select MB_NO, PWD, EMAIL,  MB_NICK, TEL, MB_NM
    from honey_membs 
    where EMAIL=#{email} and PWD=password(#{password}) 
  </select>
  
  <delete id="unregisteMember" parameterType="int">
  delete from honey_membs
  where MB_NO=#{value}
  </delete>
  
  <select id = "selectUserInfo" resultMap="memberMap" parameterType="map">
    select EMAIL, MB_NICK, MB_NM, TEL, PWD
    from honey_membs
    where MB_NO=#{userNo}
  </select>
  
  <select id = "selectUserNumber" resultMap="memberMap" parameterType="map">
    select MB_NO
    from honey_membs
    where MB_NICK=#{nickName}
  </select>
  
  <select id = "selectFollowUser" resultMap="memberMap" parameterType="map">
    select *
    from honey_flw
    where MB_NO=#{memberNo} and MB_NO2=#{followMemberNo}
  </select>  
  
  
  <update id="userInfoUpdate">
    update honey_membs set
      EMAIL=#{email},
      MB_NICK=#{nickname},
      MB_NM=#{userName},
      TEL=#{phone}
    where MB_NO=#{memberNo}
  </update>
  
  <update id="changePassword">
    update honey_membs set
      PWD=password(#{password})
    where MB_NO=#{memberNo}
  </update>
  
  
  <select id="selectBoards" parameterType="int" resultMap="boardMap">
    select *
    from 
    honey_boards
    where mb_no=#{memberNo}
  </select>
  
  <select id="selectFollowCount" parameterType="int" resultMap="boardMap">
    select *
    from 
    honey_flw
    where mb_no=#{memberNo}
  </select>
  
  
</mapper>




















